{% extends "base.html" %}

{% block title %}Modifier un produit - Gestion Commerciale{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-8 mx-auto">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-edit me-2"></i>
                    Modifier le produit "{{ produit.nom }}"
                </h5>
            </div>
            <div class="card-body">
                <form method="POST">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="nom" class="form-label">Nom du produit *</label>
                                <input type="text" class="form-control" id="nom" name="nom" 
                                       value="{{ produit.nom }}" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="code_produit" class="form-label">Code produit</label>
                                <input type="text" class="form-control" id="code_produit" name="code_produit" 
                                       value="{{ produit.code_produit or '' }}">
                                <div class="form-text">Code unique pour identifier le produit</div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="description" class="form-label">Description</label>
                        <textarea class="form-control" id="description" name="description" rows="3">{{ produit.description or '' }}</textarea>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="prix_unitaire" class="form-label">Prix unitaire (MGA) *</label>
                                <input type="number" class="form-control" id="prix_unitaire" name="prix_unitaire" 
                                       step="0.01" min="0" value="{{ produit.prix_unitaire }}" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="categorie" class="form-label">Catégorie</label>
                                <input type="text" class="form-control" id="categorie" name="categorie" 
                                       value="{{ produit.categorie or '' }}" list="categories">
                                <datalist id="categories">
                                    <option value="Électronique">
                                    <option value="Vêtements">
                                    <option value="Alimentaire">
                                    <option value="Maison">
                                    <option value="Sport">
                                </datalist>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="stock_actuel" class="form-label">Stock actuel</label>
                                <input type="number" class="form-control" id="stock_actuel" name="stock_actuel" 
                                       value="{{ produit.stock_actuel }}" min="0">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="stock_minimum" class="form-label">Stock minimum</label>
                                <input type="number" class="form-control" id="stock_minimum" name="stock_minimum" 
                                       value="{{ produit.stock_minimum }}" min="0">
                                <div class="form-text">Seuil d'alerte pour le stock faible</div>
                            </div>
                        </div>
                    </div>

                    <!-- Informations supplémentaires -->
                    <div class="card bg-light mb-3">
                        <div class="card-body">
                            <small class="text-muted">
                                <i class="fas fa-info-circle me-1"></i>
                                Produit créé le {{ produit.date_creation.strftime('%d/%m/%Y à %H:%M') }}
                            </small>
                        </div>
                    </div>

                    <div class="d-flex justify-content-between">
                        <a href="{{ url_for('produits') }}" class="btn btn-secondary">
                            <i class="fas fa-times me-1"></i>Annuler
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save me-1"></i>Enregistrer les modifications
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Formater le prix en temps réel
document.getElementById('prix_unitaire').addEventListener('input', function(e) {
    const value = parseFloat(e.target.value);
    if (value && value > 0) {
        const formatted = new Intl.NumberFormat('fr-FR').format(value);
        e.target.setAttribute('title', formatted + ' MGA');
    }
});
</script>
{% endblock %}
